(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&c(a)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const O=["https://brasilapi.com.br/api/cep/v2/","https://cep.awesomeapi.com.br/json/"],L=document.querySelector(".cart__address"),W=async e=>(await Promise.any(O.map(async t=>fetch(`${t}${e}`)))).json(),D=async e=>{try{const t=await W(e);if(!t.address&&!t.street)throw new Error("CEP não encontrado");const o=t.address??t.street,c=t.district??t.neighborhood;L.innerHTML=`${o} - ${c} - ${t.city} - ${t.state}`}catch(t){console.error(t),L.innerHTML="CEP não encontrado"}},f=["https://api.mercadolibre.com/sites/MLB/search?","https://api.mercadolibre.com/items/","https://api.mercadolibre.com/sites/MLB/categories"],I=async e=>{if(!e)throw new Error("ID não informado");return(await fetch(`${f[1]}${e}`)).json()},H=async(e,t)=>{if(!e)throw new Error("Termo de busca não informado");return(await(await fetch(`${f[0]}${t}=${e}`)).json()).results},j=async()=>(await fetch(f[2])).json(),g=()=>{const e=localStorage.getItem("cartProducts");return e?JSON.parse(e):[]},A=e=>{if(!e)throw new Error("Você deve fornecer um ID");const o=[...g(),e];localStorage.setItem("cartProducts",JSON.stringify(o))},R=e=>{if(!e)throw new Error("Você deve fornecer um ID");const t=[...g()],o=t.indexOf(e);t.splice(o,1),localStorage.setItem("cartProducts",JSON.stringify(t))},h=e=>{const t=document.createElement("img");return t.className="product__image",t.src=e.replace("I.jpg","O.jpg"),t},s=(e,t,o="")=>{const c=document.createElement(e);return c.className=t,c.innerText=o,c},J=(e,t)=>{e.remove(),R(t)},$=({id:e,title:t,price:o,pictures:c})=>{const n=document.createElement("li");n.className="cart__product";const r=s("div","cart__product__image-container"),a=h(c[0].url);r.appendChild(a);const m=h((c[1]||c[0]).url);r.appendChild(m),n.appendChild(r);const y=s("div","cart__product__info-container");y.appendChild(s("span","product__title",t));const v=s("span","product__price","R$ ");v.appendChild(s("span","product__price__value",o)),y.appendChild(v),n.appendChild(y);const B=s("i","material-icons cart__product__remove","delete");return n.appendChild(B),n.addEventListener("click",()=>J(n,e)),n},k=({id:e,title:t,thumbnail:o,price:c})=>{const n=document.createElement("section");n.className="product",n.appendChild(s("span","product__id",e));const r=s("div","img__container");r.appendChild(h(o)),n.appendChild(r),n.appendChild(s("span","product__title",t));const a=s("span","product__price","R$ ");a.appendChild(s("span","product__price__value",c)),n.appendChild(a);const m=s("button","product__add","Adicionar ao carrinho!");return n.appendChild(m),n};const i=document.querySelector(".products"),N=document.querySelector("ol.cart__products"),U=document.querySelector(".total-price"),u=document.querySelector(".count-itens"),F=document.querySelector(".container-cartTitle"),V=document.querySelector(".input-group"),_=document.querySelector(".container-title"),z=document.getElementById("input-label"),p=document.getElementById("search"),d=document.getElementById("container-categories"),P=document.getElementById("list-categories"),l=document.querySelector(".cart"),C=900,T=550,w=["category","q"],S=e=>e?`<section class="loading">
        <button class="btn" type="button" disabled>
          <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true">
          </span>
          Carregando...
        </button>
      </section>`:"",x=()=>{const e=document.querySelectorAll(".cart__product__info-container"),t=[...e];U.innerHTML=t.reduce((o,c,n)=>{const r=Number(e[n].lastChild.lastChild.innerText);return o+r},0).toFixed(2)},M=()=>{const e=document.querySelectorAll(".cart__product__info-container");e.length?(u.innerHTML=e.length,u.style.display="block"):(u.innerHTML=0,u.style.display="none",l.style.display="none",i.style.marginRight="0")},K=async()=>{const e=g();(await Promise.all(e.map(async o=>I(o)))).forEach(o=>{N.appendChild($(o))}),x(),M()},q=e=>{i.innerHTML=`<section class="error">
  ${e.message}. Recarregue a página ou tente novamente!
  </section>`,console.error(e)},Q=async()=>{const e=await j();P.innerHTML="",e.forEach(({id:t,name:o})=>{P.innerHTML+=`<li class="category">${o}
    <span class="id-category">${t}</span></li>`})},E=e=>{let t=JSON.parse(localStorage.getItem("preferences"));t?t[e]=t[e]?t[e]+1:1:t={[e]:1},localStorage.setItem("preferences",JSON.stringify(t))},G=e=>Math.round(Math.random()*e),b=async(e="computador",t)=>{i.innerHTML=S(!0);const o=await H(e,t);if(i.innerHTML=S(!1),!o.length)throw new Error("Busca inválida! Item não encontrado/existe");o.forEach(c=>i.appendChild(k(c)))},X=async e=>{const t=e.parentNode.firstChild.innerText;A(t);const o=await I(t);E(o.category_id),N.appendChild($(o))};(async function(){try{await Q();const t=JSON.parse(localStorage.getItem("preferences"));let o;if(t)[o]=Object.entries(t).reduce((n,[r,a])=>a>n[1]?[r,a]:n,["",0]);else{const n=document.getElementsByClassName("id-category"),r=G(n.length-1);o=n[r].innerText}const c=o.includes("MLB")?0:1;await b(o,w[c]),await K()}catch(t){q(t)}})();V.addEventListener("submit",async e=>{e.preventDefault();try{const{value:t}=document.getElementById("search");await b(t,w[1]),E(t)}catch(t){q(t)}});document.addEventListener("click",async e=>{const t=e.target;if(t.classList.contains("product__add")&&await X(t),t.classList.contains("category")){await b(t.lastChild.innerText,w[0]),E(t.lastChild.innerText),d.style.display="none";const o=d.style.display==="none";window.innerWidth>C&&(i.style.marginLeft=o?`${d.clientWidth}px`:"0")}else x(),M()});document.querySelector(".cep-button").addEventListener("click",async()=>{const{value:e}=document.querySelector(".cep-input");await D(e)});F.addEventListener("click",()=>{const e=l.style.display==="none";Number(u.innerText)&&(l.style.display=e?"flex":"none",window.innerWidth>C?i.style.marginRight=e?`${l.clientWidth}px`:"0":d.style.display=d.style.display!=="none"&&"none")});_.addEventListener("click",()=>{const e=d.style.display==="none";d.style.display=e?"block":"none",window.innerWidth>C?i.style.marginLeft=e?`${d.clientWidth}px`:"0":l.style.display=l.style.display!=="none"&&"none"});z.addEventListener("click",()=>{if(window.innerWidth<=T){const e=p.style.display==="none"||!p.style.display;p.style.display=e?"block":"none",_.style.display=p.style.display==="none"?"block":"none"}});window.addEventListener("resize",()=>{const e=window.innerWidth>T;p.style.display=e?"block":"none",_.style.display="block"});
